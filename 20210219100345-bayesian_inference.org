#+title: Bayesian inference
#+roam_tags: statistics bayes bayesian inference

- tags :: [[file:20210219102643-statistics.org][Statistics]]

* Bayesian inference
#+begin_src jupyter-python
H, E = symbols('H E')
bayesian_eq = LEq(Prob(H, condition=E), (Prob(E, condition=H)*Prob(H))/Prob(E))
bayesian_eq
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}P[H|E] = P[E|H] P[H] P[E]^{-1}\end{equation}
:END:

** Example
Suppose we have two jars of green and red marbles. Jar 1 has 10 green and 30 red
marbles, while jar 2 has 20 of each. If you pick a jar at random, then a marble
at random. The marble turns out to be a red one. How probable is it that you
picked it from jar 1?

The possible hypotheses is,

#+begin_src jupyter-python
H1, H2, m, J1, J2 = symbols('H_1 H_2 m J1 J2')
class LContains(Expr):
    def _latex(self, printer):
        return f"{printer._print(self.args[0])}\\in {printer._print(self.args[1])}"

    def doit(self):
        return Contains(*self.args)
LCases(
    LBiOp(':', H1, "\\text{picked marble is from jar 1}"),
    LBiOp(':', H2, "\\text{picked marble is from jar 2}")
)
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}\begin{cases}
H_{1} : \text{picked marble is from jar 1}\\
H_{2} : \text{picked marble is from jar 2}
\end{cases}\end{equation}
:END:

and the evidence is,
#+begin_src jupyter-python
LBiOp(':', E, "\\text{picked a red marble}")
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}E : \text{picked a red marble}\end{equation}
:END:

#+begin_src jupyter-python
PH1 = Prob(H1)
PH2 = Prob(H2)
PEH1 = Prob(E, condition=H1)
PEH2 = Prob(E, condition=H2)
PE = Prob(E)
V = {
    PH1: 1/2,
    PH2: 1/2,
    PEH1: 30/40,
    PEH2: 20/40,
}
#+end_src

#+RESULTS:

#+begin_src jupyter-python
bayes_ex = (PEH1 * PH1) / (PEH1 * PH1 + PEH2 * PH2)
LEq(Prob(H1, condition=E), bayes_ex, bayes_ex.subs(V))
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}P[H_{1}|E] = P[E|H_{1}] P[H_{1}] \left(P[E|H_{1}] P[H_{1}] + P[E|H_{2}] P[H_{2}]\right)^{-1} = 0.6\end{equation}
:END:
