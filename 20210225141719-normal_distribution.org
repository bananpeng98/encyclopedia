#+title: Normal distribution
#+roam_tags: statistics distribution normal

* Setup :noexport:
#+call: init()
#+call: init-plot-style()

#+begin_src jupyter-python
import matplotlib.pyplot as plt
import numpy as np
from sympy import *
from pyorg.latex import *
from sympy.stats import *
#+end_src

#+RESULTS:

* Normal distribution
#+begin_src jupyter-python
mu, sigma, n, xm, s, x, z, t = symbols('mu sigma n \\bar{x} s x z t')
#+end_src

#+RESULTS:
:RESULTS:
# [goto error]
: ---------------------------------------------------------------------------
: NameError                                 Traceback (most recent call last)
: <ipython-input-27-c1f0693360b6> in <module>
:       1 mu, sigma, n, xm, s, x, z, t = symbols('mu sigma n \\bar{x} s x z t')
: ----> 2 T = RandomSymbol('T')
:
: NameError: name 'RandomSymbol' is not defined
:END:

#+begin_src jupyter-python
Z = Normal('Z', mu, sigma)
Zstd = Normal('Z', 0, 1)
#+end_src

#+RESULTS:

** PDF
#+begin_src jupyter-python
phi = symbols('phi', cls=Function)
phi_f = lambda x: LEq(phi(x), density(Zstd)(x))
phi_f(x)
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}\phi{\left(x \right)} = \frac{\sqrt{2} e^{- \frac{x^{2}}{2}}}{2 \sqrt{\pi}}\end{equation}
:END:

#+thumb:
#+begin_src jupyter-python :results output
x_n = np.linspace(-5, 5, 200)
plt.plot(x_n, lambdify(x, phi_f(x).rhs)(x_n))
plt.title("Normal PDF")
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/e59cb125b112d249c1484db03da9f674f1fe6b47.png]]

** CDF
The definition of the cumulative distribution is using the [[file:20210301091142-error_function.org][error function]].
#+begin_src jupyter-python
Phi = symbols('Phi', cls=Function)
Phi_f = lambda x: LEq(Phi(x), cdf(Zstd)(x))
Phi_f(x)
#+end_src

#+RESULTS:
:RESULTS:
\begin{equation}\Phi{\left(x \right)} = \frac{\operatorname{erf}{\left(\frac{\sqrt{2} x}{2} \right)}}{2} + \frac{1}{2}\end{equation}
:END:

#+begin_src jupyter-python :results output
x_n = np.linspace(-5, 5, 200)
plt.plot(x_n, lambdify(x, Phi_f(x).rhs)(x_n))
plt.title("Normal CDF")
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/0c8bec99c2f4c82873188b3bd17adaac6e661290.png]]
